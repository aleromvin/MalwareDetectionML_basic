# App Deployment
# Alexander Romero Vinogradov, <aleromvin@gmail.com>
#
# This is a script for deploying the shiny document.
# The user may optionaly enable multithreading capabilities. 
# However, this requires a certain amount of previous configuration.

# Some parameters that you may want to configure:

clArgs <- commandArgs()

if ("--port" %in% clArgs) {
  
  portIndex = which(clArgs %in% "--port") + 1
  port <- as.numeric(clArgs[portIndex])
  
} else {port <- 5225}

# browser = F # The browser that will open the app the first time it runs.
            # Default option "FALSE" means the app runs without opening in any browser 
            # (ideal for deployment on remote servers for others to access)

multithreading <- F # Enable multithreading: True or False, doesn't do anything yet

nports <- 100 # Number of open ports for multithreaded deployment, doesn't do anything yet

###########################
# Normal deployment:

rmarkdown::run(file = "./interactive.Rmd", shiny_args = list(launch.browser = F, port = port))

###########################
# Multithreaded deployment

# Step 1: open several ports on your server
#
# Step 2: connect to (or create) a database with two columns:
# Column 1: Port (number) | Column 2: Status (used / free)
# The port numbers have to be the same as the ports that are opened in step 1,
# and status has to be set to 0 (free) for all ports at deployment
#
# Step 3: load balancer

